<header class="header" href="#" [routerLink]="['/dashboard']" routerLinkActive="router-link-active">POEMS BLOG/PERFIL DE USUARIO</header>
<div class="container-fluid d-flex">
  <!-- Sidebar con perfil -->
<div class="profile-box p-4 text-center">
  <div class="user-avatar mx-auto">
    <img  [src]="selectedUser.image_url" alt="Imagen de perfil" class="rounded-circle">
  </div>
  <h3 class="profile-name mt-3">{{ selectedUser.username || 'Usuario' }}</h3>
  <p class="profile-bio">{{ selectedUser.description || 'No hay biografía disponible.' }}</p>
  <p class="profile-stat"><strong>Poemas:</strong> {{ poems.length }}</p>
  <p class="profile-stat"><strong>Ratings:</strong> {{ ratings.length }}</p>
</div>

  <!-- Contenido principal -->
  <div class="content flex-grow-1 p-4 bg-white">
    <!-- Barra de búsqueda -->
    <div class="search-bar mb-3">
      <input type="text" class="form-control search-input" placeholder="BUSCAR POEMAS" (input)="onSearch($event)">
    </div>

    <!-- Botones de selección -->
    <div class="btn-group w-100">
      <button class="btn btn-toggle" [class.active]="viewing === 'poems'" (click)="viewPoems()">POEMAS 
        <span class="badge bg-dark ms-2">{{ poems.length }}</span>
      </button>
      <button class="btn btn-toggle" [class.active]="viewing === 'ratings'" (click)="viewRatings()">RATINGS 
        <span class="badge bg-dark ms-2">{{ ratings.length }}</span>
      </button>
    </div>

    <!-- Sección de Poemas -->
    <div *ngIf="viewing === 'poems'" class="poems-section mt-3">
      <div class="row g-3">
        <div class="col-md-6" *ngFor="let poem of poems">
          <div class="poem-card bg-white p-3 border rounded">
            <h5>{{ poem.title }}</h5>
            <p>{{ poem.description }}</p>
            <p class="text-muted">Autor: {{ selectedUser.username }}</p>
            <p class="text-muted">Creado: {{ poem.date_created | date:'dd/MM/yyyy' }}</p>
            <div class="actions">
              <i class="fas fa-edit" (click)="openEditPoemModal(poem)"></i>
              <i class="fas fa-trash text-danger" (click)="confirmDeletePoem(poem.id)"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sección de Ratings -->
    <div *ngIf="viewing === 'ratings'" class="ratings-section mt-3">
      <div class="row g-3">
        <div class="col-md-6" *ngFor="let rating of ratings">
          <div class="rating-card bg-white p-3 border rounded">
            <h5>🌟 {{ rating.stars }}</h5>
            <p>{{ rating.comment }}</p>
            <p class="text-muted">Poema ID: {{ rating.poem_id }}</p>
            <p class="text-muted">Fecha: {{ rating.date_created | date:'short' }}</p>
            <div class="actions">
              <i class="fas fa-edit" (click)="openEditRatingModal(rating)"></i>
              <i class="fas fa-trash text-danger" (click)="confirmDeleteRating(rating.id)"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MODAL DE EDICIÓN DE POEMA -->
<div id="editPoemModal" class="modal fade" tabindex="-1" aria-labelledby="editPoemModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Poema</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <label>Título:</label>
        <input type="text" class="form-control mb-3" [(ngModel)]="selectedPoem.title">
        
        <label>Descripción:</label>
        <textarea class="form-control mb-3" rows="3" [(ngModel)]="selectedPoem.description"></textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="updatePoem()">Guardar Cambios</button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL DE EDICIÓN DE RATING -->
<div id="editRatingModal" class="modal fade" tabindex="-1" aria-labelledby="editRatingModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Rating</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <label>Calificación (1-5 estrellas):</label>
        <select class="form-control mb-3" [(ngModel)]="selectedRating.stars">
          <option *ngFor="let num of [1, 2, 3, 4, 5]" [value]="num">{{ num }}</option>
        </select>

        <label>Comentario:</label>
        <textarea class="form-control mb-3" rows="3" [(ngModel)]="selectedRating.comment"></textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="updateRating()">Guardar Cambios</button>
      </div>
    </div>
  </div>
</div>

<!-- COMPONENTE FOOTER -->
<footer class="footer">
  <p>&copy;2024 POEMS BLOG / EL LUGAR DONDE LAS PALABRAS COBRAN VIDA.</p>
</footer>
